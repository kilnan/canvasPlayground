<html>
<head>
	<script>
		var ready = false;
		var canvas = null;
		var ctx = null;
		var sprites = [];
		var gravityInPixelsPerSecond = 100;
		var worldWidth = 400;
		var worldHeight = 200;

		window.requestAnimFrame = (function(){
		  return  window.requestAnimationFrame       ||
		          window.webkitRequestAnimationFrame ||
		          window.mozRequestAnimationFrame    ||
		          function( callback ){
		            window.setTimeout(callback, 1000 / 60);
		          };
		})();

		function initialize() {
			canvas = document.getElementById('tutorial');
			ctx = canvas.getContext('2d');
			ready = true;

			sprites.push({
				type: 'rectangle',
				x: 0,
				y: 0,
				width: 20,
				height: 20,
				color: '#FF0000',
				gravity: true,
				xMovement: 0,
				yMovement: 0
			});
			animateWorld();
		}

		function onAnimationFrame() {
			if (!ready) {
				return;
			}

			ctx.fillStyle = "#DDDDDD";
			ctx.fillRect(0, 0, worldWidth, worldHeight);

			for (var i = 0; i < sprites.length; i++) {
				var sprite = sprites[i];
				if (sprite.type === 'rectangle') {
					ctx.fillStyle = sprite.color;
					ctx.fillRect(sprite.x, 
						sprite.y,
						sprite.width,
						sprite.height);
				}
			}
			
		}

		function animateWorld() {
			var interval = 10;
			window.setInterval(function () {
				for (var i = 0; i < sprites.length; i++) {
					var sprite = sprites[i];
					var pixelsToMoveY = sprite.xMovement;
					var pixelsToMoveX = sprite.yMovement;

					sprite.xMovement = 0;
					sprite.yMovement = 0;

					if (sprite.gravity) {
						pixelsToMoveY = pixelsToMoveY + gravityInPixelsPerSecond * interval / 1000;
					}
					sprite.y = sprite.y + pixelsToMoveY;
					if (sprite.y + sprite.height > worldHeight)
					{
						sprite.y = worldHeight - sprite.height;
					}
					sprite.x = sprite.x + pixelsToMoveX;
					if (sprite.x + sprite.width > worldWidth)
					{
						sprite.x = worldWidth - sprite.width;
					}
				}
			}, interval);
		}

		window.onload = initialize;
		window.setInterval(onAnimationFrame, 10);
	</script>
</head>
<body>
	<canvas id="tutorial" width="400" height="200"></canvas>
</body>
</html>
