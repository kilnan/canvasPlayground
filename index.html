<html>
<head>
	<script>
		var ready = false;
		var canvas = null;
		var ctx = null;
		var sprites = [];
		var gravityInPixelsPerSecond = 100;

		window.requestAnimFrame = (function(){
		  return  window.requestAnimationFrame       ||
		          window.webkitRequestAnimationFrame ||
		          window.mozRequestAnimationFrame    ||
		          function( callback ){
		            window.setTimeout(callback, 1000 / 60);
		          };
		})();

		function initialize() {
			canvas = document.getElementById('tutorial');
			ctx = canvas.getContext('2d');
			ready = true;

			sprites.push({
				type: 'rectangle',
				x: 0,
				y: 0,
				width: 20,
				height: 20,
				color: '#FF0000',
				gravity: true
			});
			animateWorld();
		}

		function onAnimationFrame() {
			if (!ready) {
				return;
			}

			ctx.fillStyle = "#DDDDDD";
			ctx.fillRect(0,0,400,400);

			for (var i = 0; i < sprites.length; i++) {
				var sprite = sprites[i];
				if (sprite.type === 'rectangle') {
					ctx.fillStyle = sprite.color;
					ctx.fillRect(sprite.x, 
						sprite.y,
						sprite.width,
						sprite.height);
				}
			}
			
		}

		function animateWorld() {
			var interval = 10;
			window.setInterval(function () {
				for (var i = 0; i < sprites.length; i++) {
					var sprite = sprites[i];
					if (sprite.gravity) {
						var pixelsToMove = gravityInPixelsPerSecond * interval / 1000;
						sprite.y = sprite.y + pixelsToMove;
						if (sprite.y + sprite.height > 400)
						{
							sprite.y = 400 - sprite.height;
						}
					}
				}
			}, interval);
		}

		window.onload = initialize;
		window.setInterval(onAnimationFrame, 10);
	</script>
</head>
<body>
	<canvas id="tutorial" width="400" height="400"></canvas>
</body>
</html>
